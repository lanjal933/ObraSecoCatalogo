<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba - Imagen Ampliada</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <h1>üîç Prueba - Imagen Ampliada</h1>
        
        <div class="products-grid" id="productsGrid">
            <!-- Los productos se cargar√°n aqu√≠ -->
        </div>
        
        <div class="console" id="console" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px; padding: 15px; margin-top: 20px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;">
            <strong>Consola de Pruebas:</strong><br>
            Sistema inicializado...
        </div>
    </div>

    <!-- Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent">
                <!-- Contenido del modal -->
            </div>
        </div>
    </div>

    <!-- Modal de Imagen Ampliada -->
    <div id="imageZoomModal" class="image-zoom-modal">
        <div class="image-zoom-content">
            <span class="image-zoom-close" onclick="closeImageZoom()">&times;</span>
            <img id="imageZoomImage" class="image-zoom-image" alt="Imagen Ampliada">
            <div class="image-zoom-info" id="imageZoomInfo">
                <!-- Informaci√≥n de la imagen -->
            </div>
            <div class="image-zoom-nav" id="imageZoomNav">
                <!-- Navegaci√≥n entre im√°genes -->
            </div>
        </div>
    </div>

    <script>
        // Productos de ejemplo con im√°genes m√∫ltiples
        let products = [
            {
                id: 1,
                name: "Torno CNC Industrial",
                category: "maquinaria",
                description: "Torno de control num√©rico de alta precisi√≥n para fabricaci√≥n industrial.",
                price: 45000,
                image: "fas fa-cog",
                hasMultipleImages: true,
                images: [
                    {
                        base64: "https://via.placeholder.com/800x600/007bff/ffffff?text=Torno+CNC+Vista+Frontal+HD",
                        name: "Torno CNC - Vista Frontal HD"
                    },
                    {
                        base64: "https://via.placeholder.com/800x600/28a745/ffffff?text=Torno+CNC+Vista+Lateral+HD",
                        name: "Torno CNC - Vista Lateral HD"
                    },
                    {
                        base64: "https://via.placeholder.com/800x600/ff9800/ffffff?text=Torno+CNC+Vista+Superior+HD",
                        name: "Torno CNC - Vista Superior HD"
                    }
                ],
                specifications: {
                    "Capacidad": "500mm x 1000mm",
                    "Precisi√≥n": "¬±0.01mm",
                    "Potencia": "15kW",
                    "Peso": "2500kg"
                }
            },
            {
                id: 2,
                name: "Fresadora Universal",
                category: "maquinaria",
                description: "Fresadora de 5 ejes con mesa de trabajo amplia y sistema de control avanzado.",
                price: 32000,
                image: "fas fa-cogs",
                hasMultipleImages: true,
                images: [
                    {
                        base64: "https://via.placeholder.com/800x600/dc3545/ffffff?text=Fresadora+Vista+Principal+HD",
                        name: "Fresadora - Vista Principal HD"
                    },
                    {
                        base64: "https://via.placeholder.com/800x600/17a2b8/ffffff?text=Fresadora+Mesa+de+Trabajo+HD",
                        name: "Fresadora - Mesa de Trabajo HD"
                    }
                ],
                specifications: {
                    "Mesa": "1200mm x 300mm",
                    "Ejes": "5 ejes controlados",
                    "Velocidad": "6000 RPM",
                    "Peso": "1800kg"
                }
            }
        ];
        
        // Funci√≥n para mostrar en consola
        function log(message) {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            console.innerHTML += `<br>[${timestamp}] ${message}`;
            console.scrollTop = console.scrollHeight;
        }
        
        // Funci√≥n para crear tarjeta de producto
        function createProductCard(product) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            
            // Determinar qu√© imagen mostrar
            let imageContent = '';
            if (product.hasMultipleImages && product.images && product.images.length > 0) {
                // Mostrar la primera imagen como principal, con indicador de m√∫ltiples im√°genes
                imageContent = `
                    <div class="product-image multiple-images">
                        <img src="${product.images[0].base64}" alt="${product.name}" class="product-custom-image">
                        <div class="image-counter">+${product.images.length - 1}</div>
                    </div>
                `;
            } else {
                // Mostrar icono
                imageContent = `
                    <div class="product-image">
                        <i class="${product.image}"></i>
                    </div>
                `;
            }
            
            productCard.innerHTML = `
                ${imageContent}
                <div class="product-info">
                    <div class="product-category">
                        <i class="fas fa-tag"></i>
                        ${product.category}
                    </div>
                    <div class="product-title">${product.name}</div>
                    <div class="product-description">${product.description}</div>
                    <div class="product-price">$${product.price}</div>
                    <div class="product-actions">
                        <button class="btn btn-primary btn-small" onclick="viewProduct(${product.id})">
                            <i class="fas fa-eye"></i> Ver Detalles
                        </button>
                    </div>
                </div>
            `;
            
            return productCard;
        }
        
        // Funci√≥n para renderizar productos
        function renderProducts() {
            const productsGrid = document.getElementById('productsGrid');
            productsGrid.innerHTML = '';
            
            products.forEach(product => {
                const productCard = createProductCard(product);
                productsGrid.appendChild(productCard);
            });
            
            log(`Renderizados ${products.length} productos`);
        }
        
        // Funci√≥n para ver producto en modal
        function viewProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) {
                log(`‚ùå Producto no encontrado: ${productId}`);
                return;
            }
            
            log(`Abriendo modal para: ${product.name}`);
            
            // Crear contenido de im√°genes
            let imageContent = '';
            if (product.hasMultipleImages && product.images && product.images.length > 0) {
                // Galer√≠a de m√∫ltiples im√°genes
                imageContent = `
                    <div class="image-gallery">
                        <div class="gallery-thumbnails">
                            ${product.images.map((img, index) => `
                                <div class="gallery-thumbnail ${index === 0 ? 'active' : ''}" onclick="showImage(${index})">
                                    <img src="${img.base64}" alt="${img.name}" title="${img.name}">
                                </div>
                            `).join('')}
                        </div>
                        <div class="main-image-container">
                            <img src="${product.images[0].base64}" alt="${product.name}" id="mainProductImage" class="main-product-image" onclick="openImageZoom()">
                            <div class="image-info">
                                <span class="image-name">${product.images[0].name}</span>
                                <span class="image-counter">1 / ${product.images.length}</span>
                            </div>
                        </div>
                        ${product.images.length > 1 ? `
                            <div class="image-navigation">
                                <button class="nav-btn prev" onclick="changeImage(-1)">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="nav-btn next" onclick="changeImage(1)">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        ` : ''}
                    </div>
                `;
            } else {
                // Imagen √∫nica (icono)
                imageContent = `
                    <div class="modal-image">
                        <i class="${product.image}"></i>
                    </div>
                `;
            }
            
            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <div class="modal-header">
                    <div class="modal-title">${product.name}</div>
                    <div class="modal-category">${product.category.toUpperCase()}</div>
                </div>
                
                ${imageContent}
                
                <p style="margin: 20px 0; line-height: 1.6;">${product.description}</p>
                
                <div class="specifications">
                    <h4>Especificaciones T√©cnicas:</h4>
                    <ul>
                        ${Object.entries(product.specifications).map(([key, value]) => 
                            `<li><strong>${key}:</strong> ${value}</li>`
                        ).join('')}
                    </ul>
                </div>
            `;
            
            // Guardar referencia a las im√°genes del producto actual
            window.currentProductImages = product.hasMultipleImages ? product.images : null;
            window.currentImageIndex = 0;
            
            document.getElementById('productModal').style.display = 'block';
            log('‚úÖ Modal abierto correctamente');
            log('üí° Haz clic en la imagen principal para ampliarla');
        }
        
        // Funci√≥n para cerrar modal
        function closeModal() {
            document.getElementById('productModal').style.display = 'none';
            
            // Limpiar variables globales
            window.currentProductImages = null;
            window.currentImageIndex = 0;
            
            log('Modal cerrado');
        }
        
        // Funci√≥n para mostrar imagen espec√≠fica
        function showImage(index) {
            if (!window.currentProductImages || index < 0 || index >= window.currentProductImages.length) return;
            
            window.currentImageIndex = index;
            const mainImage = document.getElementById('mainProductImage');
            const imageCounter = document.querySelector('.image-counter');
            const imageName = document.querySelector('.image-name');
            
            if (mainImage) {
                mainImage.src = window.currentProductImages[index].base64;
            }
            
            if (imageCounter) {
                imageCounter.textContent = `${index + 1} / ${window.currentProductImages.length}`;
            }
            
            if (imageName) {
                imageName.textContent = window.currentProductImages[index].name;
            }
            
            // Actualizar galer√≠a activa
            const galleryThumbnails = document.querySelectorAll('.gallery-thumbnail');
            galleryThumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
            
            log(`Imagen ${index + 1} mostrada`);
        }
        
        // Funci√≥n para cambiar imagen
        function changeImage(direction) {
            if (!window.currentProductImages) return;
            
            let newIndex = window.currentImageIndex + direction;
            
            if (newIndex < 0) {
                newIndex = window.currentProductImages.length - 1;
            } else if (newIndex >= window.currentProductImages.length) {
                newIndex = 0;
            }
            
            showImage(newIndex);
        }
        
        // Funciones para el modal de imagen ampliada
        function openImageZoom() {
            if (!window.currentProductImages || window.currentImageIndex === undefined) return;
            
            const currentImage = window.currentProductImages[window.currentImageIndex];
            const imageZoomModal = document.getElementById('imageZoomModal');
            const imageZoomImage = document.getElementById('imageZoomImage');
            const imageZoomInfo = document.getElementById('imageZoomInfo');
            const imageZoomNav = document.getElementById('imageZoomNav');
            
            // Configurar imagen ampliada
            imageZoomImage.src = currentImage.base64;
            imageZoomInfo.innerHTML = `
                <strong>${currentImage.name}</strong><br>
                <small>${window.currentImageIndex + 1} / ${window.currentProductImages.length}</small>
            `;
            
            // Configurar navegaci√≥n si hay m√∫ltiples im√°genes
            if (window.currentProductImages.length > 1) {
                imageZoomNav.innerHTML = `
                    <button class="nav-btn" onclick="changeZoomImage(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="nav-btn" onclick="changeZoomImage(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                `;
            } else {
                imageZoomNav.innerHTML = '';
            }
            
            // Mostrar modal
            imageZoomModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            log('üîç Imagen ampliada abierta');
        }
        
        function closeImageZoom() {
            const imageZoomModal = document.getElementById('imageZoomModal');
            imageZoomModal.style.display = 'none';
            document.body.style.overflow = 'auto';
            
            log('üîç Imagen ampliada cerrada');
        }
        
        function changeZoomImage(direction) {
            if (!window.currentProductImages) return;
            
            let newIndex = window.currentImageIndex + direction;
            
            if (newIndex < 0) {
                newIndex = window.currentProductImages.length - 1;
            } else if (newIndex >= window.currentProductImages.length) {
                newIndex = 0;
            }
            
            // Cambiar imagen en el modal ampliado
            window.currentImageIndex = newIndex;
            const currentImage = window.currentProductImages[newIndex];
            const imageZoomImage = document.getElementById('imageZoomImage');
            const imageZoomInfo = document.getElementById('imageZoomInfo');
            
            imageZoomImage.src = currentImage.base64;
            imageZoomInfo.innerHTML = `
                <strong>${currentImage.name}</strong><br>
                <small>${newIndex + 1} / ${window.currentProductImages.length}</small>
            `;
            
            // Actualizar tambi√©n la imagen en el modal principal
            const mainImage = document.getElementById('mainProductImage');
            if (mainImage) {
                mainImage.src = currentImage.base64;
            }
            
            // Actualizar galer√≠a activa
            const galleryThumbnails = document.querySelectorAll('.gallery-thumbnail');
            galleryThumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
            
            // Actualizar contador en el modal principal
            const imageCounter = document.querySelector('.image-counter');
            const imageName = document.querySelector('.image-name');
            
            if (imageCounter) {
                imageCounter.textContent = `${newIndex + 1} / ${window.currentProductImages.length}`;
            }
            
            if (imageName) {
                imageName.textContent = currentImage.name;
            }
            
            log(`üîç Imagen ampliada cambiada a: ${currentImage.name}`);
        }
        
        // Cerrar modal al hacer clic fuera
        window.onclick = function(event) {
            const modal = document.getElementById('productModal');
            if (event.target === modal) {
                closeModal();
            }
            
            const imageZoomModal = document.getElementById('imageZoomModal');
            if (event.target === imageZoomModal) {
                closeImageZoom();
            }
        }
        
        // Cerrar modal de imagen ampliada con tecla Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeImageZoom();
            }
        });
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            log('=== SISTEMA INICIALIZADO ===');
            renderProducts();
            log('‚úÖ Productos cargados y renderizados');
            log('');
            log('üì∏ PRODUCTOS CON M√öLTIPLES IM√ÅGENES:');
            log('- Torno CNC: 3 im√°genes HD (Frontal, Lateral, Superior)');
            log('- Fresadora: 2 im√°genes HD (Principal, Mesa de Trabajo)');
            log('');
            log('üéØ FUNCIONALIDADES DISPONIBLES:');
            log('- Tarjetas con indicador de m√∫ltiples im√°genes');
            log('- Modal con galer√≠a de im√°genes');
            log('- Navegaci√≥n entre im√°genes');
            log('- Miniaturas interactivas');
            log('- üîç IMAGEN AMPLIADA al hacer clic en la imagen principal');
            log('');
            log('üí° Instrucciones:');
            log('1. Haz clic en "Ver Detalles" de cualquier producto');
            log('2. Haz clic en la imagen principal para AMPLIARLA');
            log('3. Usa las flechas para navegar entre im√°genes ampliadas');
            log('4. Presiona ESC o haz clic fuera para cerrar');
        });
    </script>
</body>
</html> 